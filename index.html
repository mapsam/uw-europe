
<!DOCTYPE html>
<meta charset="utf-8">
<title>Europe</title>
<style>
body {
  margin:0;
  padding:0;
  font-family:"Helvetica Neue", sans-serif;
}
#map {
  display:block;
  margin:auto;
  width:1000px;
  height:600px;
}
.country {
  stroke:#fff;
  stroke-weight:1px;
}
.country.one {
  fill:#fee090;
}
.country.two {
  fill:#e0f3f8;
}
.country.three {
  fill:#91bfdb;
}

.label {}
.country-label {
  text-transform:uppercase;
  font-size:.6em;
  font-weight:300;
  color:#c0c0c0;
}
</style>

<div id="map"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script>

var width = 1000,
    height = 600;

projection = d3.geo.orthographic()
  .translate([width / 2, height / 2])
  .scale(1135)
  .rotate([-17, -54, -1]);

path = d3.geo.path()  
  .projection(projection);  

svg = d3.select("#map").append("svg")   
  .attr("width", width)
  .attr("height", height);

queue()   
  .defer(d3.json, "/data/countries.json")
  //load more data here 
  .await(drawMap);   

function drawMap(error, countries) {
  
  // used for calculating color
  var countryLength = countries.objects.countries.geometries.length;
  var colorCount = 255 / countryLength;
  var color = 150;


  console.log(countries);
  var countryShapes = svg.selectAll(".countries")   
    .data(topojson.feature(countries, countries.objects.countries).features)  
    .enter().append("path")
    .attr("class", "country")
    .style("fill", "rgb(234,234,234)")
    .attr("d", path);

  var labels = svg.selectAll(".country-label")
      .data(topojson.feature(countries, countries.objects.countries).features)
      .enter().append("text")
      .attr("class", "country-label")
      .attr("text-anchor", "middle")
      .attr("id", function(d){
        return d.properties.admin;
      })
      .attr("transform", function(d) {
        // set label origin for specific countries to prevent overlap
        var labelPoint = [path.centroid(d)[0], path.centroid(d)[1]];  
        return "translate(" + labelPoint + ")";
      })
      // .attr("dy", ".35em")
      .text(function(d) { return d.properties.admin; });

  // svg.selectAll('.labels')
  //     .data(topojson.feature(countries, countries.objects.countries).features)
  //     .enter()
  //     .append('text')
  //     .attr('transform', function(d) {
  //       console.log(d);
  //       return 'translate(' + projection(d.geometry.coordinates) + ')';
  //     })
  //     .attr('dy', 0) // vertical offset
  //     .attr('dx', 0) // horizontal offset
  //     .text(function(d) {
  //       return d.properties.admin;
  //     })
  //     .attr('class', 'label label-country');
}


</script>
