
<!DOCTYPE html>
<meta charset="utf-8">
<title>Europe</title>
<style>
body {
  margin:0;
  padding:0;
  font-family:"Helvetica Neue", sans-serif;
  overflow:hidden;
}
#map {
  position:absolute;
  width:100%;
  height:100%;
  overflow:hidden;
}
.land {
  fill:#f6f6f6;
  stroke:transparent;
  stroke-weight:0px;
}
.country {
  stroke:#fff;
  stroke-weight:.25px;
}

.label {}
.country-label {
  text-transform:uppercase;
  font-size:.6em;
  font-weight:300;
  fill:#fff;
  letter-spacing:2.5px;
}
.place-label {
  font-size:.6em;
}
.place-capital {
  font-weight:900;
}
</style>

<div id="map"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script>

var width = window.innerWidth,
    height = window.innerHeight;

projection = d3.geo.orthographic()
  .translate([width / 2, height / 2])
  .scale(1100)
  .rotate([-18, -51, 5]);

path = d3.geo.path()  
  .projection(projection);  

svg = d3.select("#map").append("svg")   
  .attr("width", width)
  .attr("height", height);

queue()   
  .defer(d3.json, "/data/countries.json")
  .defer(d3.json, "/data/land.json")
  .defer(d3.json, "/data/places.geojson")
  //load more data here 
  .await(drawMap);  

var colorCount = 0;
var colors = ['#A8B6C7', '#9A8F8A', '#BDBC9C', '#E5D5B3', '#DED6CC'];

function drawMap(error, countries, land, places) {
  
  var land = svg.selectAll(".land")
    .data(topojson.feature(land, land.objects.land).features)
    .enter().append("path")
    .attr("class", "land")
    .attr("d", path);

  var countryObjects = svg.selectAll(".countries")   
    .data(topojson.feature(countries, countries.objects.countries).features)  
    .enter().append("path")
    .attr("class", "country")
    .style("fill", function(d){
      return countryColor(d.properties.admin);
    })
    .attr("d", path);

  var countryLabels = svg.selectAll(".country-label")
      .data(topojson.feature(countries, countries.objects.countries).features)
      .enter().append("text")
      .attr("class", "country-label")
      .attr("text-anchor", "middle")
      .attr("id", function(d){
        return d.properties.admin;
      })
      .attr("transform", function(d) {
        // set label origin for specific countries to prevent overlap
        var labelPoint = [path.centroid(d)[0], path.centroid(d)[1]];  
        return "translate(" + labelPoint + ")";
      })
      // .attr("dy", ".35em")
      .text(function(d) { return d.properties.admin; });

  var placePoints = svg.selectAll(".place")
    .data(places.features)
    .enter().append("path")
    .attr("d", path.pointRadius(2))
    .style("visibility", function(d){
      if (d.properties.adm0cap) return "visible";
      else return "hidden";
    })
    .attr("class", "place");

  var placeLabels = svg.selectAll('.place-label')
    .data(places.features).enter().append('text')
    .attr('transform', function(d) {
      return 'translate(' + projection(d.geometry.coordinates) + ')';
    })
    .attr('dy', -3) 
    .attr('dx', 3)
    .text(function(d) {
      return d.properties.name;
    })
    .style("visibility", function(d){
      if (d.properties.adm0cap) return "visible";
      else return "hidden";
    })
    .attr('class', function(d){
      if (d.properties.adm0cap) return "place-label place-capital";
      else return "place-label";
    });
}

function countryColor(name) {
  var attr;
  switch(name) {
    case "Albania": 
      attr = colors[4];
      break;
    case "Aland": 
      attr = colors[0];
      break;
    case "Andorra": 
      attr = colors[0];
      break;
    case "Austria": 
      attr = colors[2];
      break;
    case "Belgium": 
      attr = colors[1];
      break;
    case "Bulgaria": 
      attr = colors[0];
      break;
    case "Bosnia and Herzegovina": 
      attr = colors[4];
      break;
    case "Belarus": 
      attr = colors[4];
      break;
    case "Switzerland": 
      attr = colors[3];
      break;
    case "Czech Republic": 
      attr = colors[1];
      break;
    case "Germany": 
      attr = colors[0];
      break;
    case "Denmark": 
      attr = colors[3];
      break;
    case "Spain": 
      attr = colors[1];
      break;
    case "Estonia": 
      attr = colors[3];
      break;
    case "Finland": 
      attr = colors[1];
      break;
    case "France": 
      attr = colors[2];
      break;
    case "Faroe Islands": 
      attr = colors[0];
      break;
    case "United Kingdom": 
      attr = colors[3];
      break;
    case "Guernsey": 
      attr = colors[0];
      break;
    case "Greece": 
      attr = colors[2];
      break;
    case "Croatia": 
      attr = colors[3];
      break;
    case "Hungary": 
      attr = colors[0];
      break;
    case "Isle of Man": 
      attr = colors[0];
      break;
    case "Ireland": 
      attr = colors[1];
      break;
    case "Iceland": 
      attr = colors[0];
      break;
    case "Italy": 
      attr = colors[4];
      break;
    case "Jersey": 
      attr = colors[0];
      break;
    case "Kosovo": 
      attr = colors[3];
      break;
    case "Liechtenstein": 
      attr = colors[0];
      break;
    case "Lithuania": 
      attr = colors[1];
      break;
    case "Luxembourg": 
      attr = colors[0];
      break;
    case "Latvia": 
      attr = colors[2];
      break;
    case "Monaco": 
      attr = colors[0];
      break;
    case "Moldova": 
      attr = colors[3];
      break;
    case "Macedonia": 
      attr = colors[1];
      break;
    case "Malta": 
      attr = colors[0];
      break;
    case "Montenegro": 
      attr = colors[0];
      break;
    case "Netherlands": 
      attr = colors[4];
      break;
    case "Norway": 
      attr = colors[2];
      break;
    case "Poland": 
      attr = colors[3];
      break;
    case "Portugal": 
      attr = colors[0];
      break;
    case "Romania": 
      attr = colors[1];
      break;
    case "Russia": 
      attr = colors[0];
      break;
    case "San Marino": 
      attr = colors[0];
      break;
    case "Republic of Serbia": 
      attr = colors[2];
      break;
    case "Slovakia": 
      attr = colors[4];
      break;
    case "Slovenia": 
      attr = colors[1];
      break;
    case "Sweden": 
      attr = colors[4];
      break;
    case "Ukraine": 
      attr = colors[2];
      break;
    default:
      attr = colors[0];
      break;
  }
  return attr;
}
function countryLabelPlacement(name) {
  var attr;
  switch(name) {
    case "Albania": 
      attr = colors[4];
      break;
    case "Aland": 
      attr = colors[0];
      break;
    case "Andorra": 
      attr = colors[0];
      break;
    case "Austria": 
      attr = colors[2];
      break;
    case "Belgium": 
      attr = colors[1];
      break;
    case "Bulgaria": 
      attr = colors[0];
      break;
    case "Bosnia and Herzegovina": 
      attr = colors[4];
      break;
    case "Belarus": 
      attr = colors[4];
      break;
    case "Switzerland": 
      attr = colors[3];
      break;
    case "Czech Republic": 
      attr = colors[1];
      break;
    case "Germany": 
      attr = colors[0];
      break;
    case "Denmark": 
      attr = colors[3];
      break;
    case "Spain": 
      attr = colors[1];
      break;
    case "Estonia": 
      attr = colors[3];
      break;
    case "Finland": 
      attr = colors[1];
      break;
    case "France": 
      attr = colors[2];
      break;
    case "Faroe Islands": 
      attr = colors[0];
      break;
    case "United Kingdom": 
      attr = colors[3];
      break;
    case "Guernsey": 
      attr = colors[0];
      break;
    case "Greece": 
      attr = colors[2];
      break;
    case "Croatia": 
      attr = colors[3];
      break;
    case "Hungary": 
      attr = colors[0];
      break;
    case "Isle of Man": 
      attr = colors[0];
      break;
    case "Ireland": 
      attr = colors[1];
      break;
    case "Iceland": 
      attr = colors[0];
      break;
    case "Italy": 
      attr = colors[4];
      break;
    case "Jersey": 
      attr = colors[0];
      break;
    case "Kosovo": 
      attr = colors[3];
      break;
    case "Liechtenstein": 
      attr = colors[0];
      break;
    case "Lithuania": 
      attr = colors[1];
      break;
    case "Luxembourg": 
      attr = colors[0];
      break;
    case "Latvia": 
      attr = colors[2];
      break;
    case "Monaco": 
      attr = colors[0];
      break;
    case "Moldova": 
      attr = colors[3];
      break;
    case "Macedonia": 
      attr = colors[1];
      break;
    case "Malta": 
      attr = colors[0];
      break;
    case "Montenegro": 
      attr = colors[0];
      break;
    case "Netherlands": 
      attr = colors[4];
      break;
    case "Norway": 
      attr = colors[2];
      break;
    case "Poland": 
      attr = colors[3];
      break;
    case "Portugal": 
      attr = colors[0];
      break;
    case "Romania": 
      attr = colors[1];
      break;
    case "Russia": 
      attr = colors[0];
      break;
    case "San Marino": 
      attr = colors[0];
      break;
    case "Republic of Serbia": 
      attr = colors[2];
      break;
    case "Slovakia": 
      attr = colors[4];
      break;
    case "Slovenia": 
      attr = colors[1];
      break;
    case "Sweden": 
      attr = colors[4];
      break;
    case "Ukraine": 
      attr = colors[2];
      break;
    default:
      attr = colors[0];
      break;
  }
  return attr;
}



</script>
